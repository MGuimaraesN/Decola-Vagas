datasource db {
  provider = "mysql" // Verifique se est√° "mysql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id                  Int                   @id @default(autoincrement())
  firstName           String
  lastName            String
  email               String                @unique
  password            String
  ip                  String
  lastLogin           DateTime?
  updatedAt           DateTime              @updatedAt
  createdAt           DateTime              @default(now())
  job                 Job[]
  institutions        UserInstitutionRole[]
  activeInstitutionId Int?
  bio                 String?               @db.Text
  linkedinUrl         String?
  githubUrl           String?
  portfolioUrl        String?
  course              String?
  graduationYear      Int?
  savedJobs           SavedJob[]
}

model Job {
  id            Int         @id @default(autoincrement())
  authorId      Int
  author        User        @relation(fields: [authorId], references: [id])
  title         String
  email         String
  telephone     String
  description   String
  areaId        Int
  area          Area        @relation(fields: [areaId], references: [id])
  categoryId    Int
  category      Category    @relation(fields: [categoryId], references: [id])
  status        String
  ip            String
  lastLogin     DateTime?
  updatedAt     DateTime    @updatedAt
  createdAt     DateTime    @default(now())
  institutionId Int
  institution   Institution @relation(fields: [institutionId], references: [id])
  savedBy       SavedJob[]
  companyId     Int?
  company       Company?    @relation(fields: [companyId], references: [id])
}

model SavedJob {
  id        Int      @id @default(autoincrement())
  userId    Int
  user      User     @relation(fields: [userId], references: [id])
  jobId     Int
  job       Job      @relation(fields: [jobId], references: [id])
  createdAt DateTime @default(now())

  @@unique([userId, jobId])
}

model Company {
  id          Int     @id @default(autoincrement())
  name        String  @unique
  logoUrl     String?
  websiteUrl  String?
  description String? @db.Text
  jobs        Job[]
}

model Category {
  id   Int   @id @default(autoincrement())
  name String @unique
  job  Job[]
}

model Area {
  id   Int   @id @default(autoincrement())
  name String @unique
  job  Job[]
}

model Institution {
  id    Int                   @id @default(autoincrement())
  name  String                @unique
  jobs  Job[]
  users UserInstitutionRole[]
}

model Role {
  id    Int                   @id @default(autoincrement())
  name  String                @unique
  users UserInstitutionRole[]
}

model UserInstitutionRole {
  id            Int         @id @default(autoincrement())
  userId        Int
  user          User        @relation(fields: [userId], references: [id])
  institutionId Int
  institution   Institution @relation(fields: [institutionId], references: [id])
  roleId        Int
  role          Role        @relation(fields: [roleId], references: [id])

  @@unique([userId, institutionId, roleId])
}
